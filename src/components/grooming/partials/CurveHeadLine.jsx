import gsap from "gsap";
import { ScrollTrigger } from "gsap/all";
import { useEffect, useLayoutEffect, useRef } from "react";

gsap.registerPlugin(ScrollTrigger);

const CurveHeadLine = () => {
  const tpRef = useRef(null);
  const textRef = useRef(null);
  const svgRef = useRef(null);

  useLayoutEffect(() => {
    const ctx = gsap.context(() => {
      const tp = tpRef.current;

      gsap.set(tpRef.current, {
        attr: { startOffset: "-30%" },
      });
      gsap.set(textRef.current, { opacity: 0, letterSpacing: 2 });

      ScrollTrigger.create({
        trigger: svgRef.current,
        start: "top 80%",
        // end: 'top 20%',
        // markers: true,

        onEnter: () => {
          gsap.to(tpRef.current, {
            attr: { startOffset: "28%" },
            duration: 3,
          });
          gsap.to(textRef.current, { opacity: 1, letterSpacing: 0.5 });
        },
      });
    }, svgRef);
    return () => ctx.revert();
  }, []);

  return (
    <div className="headlineWrap">
      <svg
        className="headline"
        ref={svgRef}
        width="1200"
        viewBox="0 0 1200 100"
        role="img"
        aria-label="예뻐질 준비, 됐개?"
      >
        <path id="curve" d="M80,180 C380,20 820,20 1120,180" fill="none" />

        <text
          ref={textRef}
          fontSize="68"
          fontWeight="700"
          fontFamily="Paperlogy"
        >
          <textPath ref={tpRef} href="#curve" startOffset="0%">
            {/* 부분 색상 분리 */}
            <tspan fill="#4A9F99">예뻐</tspan>
            <tspan fill="#060606 ">질 준비, 됐개?</tspan>
          </textPath>
        </text>
      </svg>
      <svg
        className="headlineMobile"
        xmlns="http://www.w3.org/2000/svg"
        width="314"
        height="44"
        viewBox="0 0 314 44"
        fill="none"
      >
        <path
          d="M35.4956 39.0324L30.3191 39.5256L27.0813 5.5462L32.2579 5.05295L35.4956 39.0324ZM24.3066 5.94453L27.4769 39.2161L22.3446 39.7051L21.5562 31.4315L17.6628 31.8025C17.3792 34.4487 16.7051 36.4327 15.6404 37.7545C14.6053 39.0734 13.1882 39.8186 11.3889 39.99C8.82274 40.2346 6.76989 39.1503 5.23036 36.7373C3.71751 34.292 2.69408 30.2673 2.16007 24.663C1.62606 19.0588 1.87237 14.9279 2.89898 12.2704C3.95229 9.58057 5.76202 8.1134 8.32817 7.86887C11.6907 7.54847 14.1537 9.50142 15.7172 13.7277L19.8319 13.3356L19.1743 6.43358L24.3066 5.94453ZM10.8872 34.725C11.8016 34.6379 12.369 33.7207 12.5894 31.9734C12.8365 30.1937 12.7816 27.4309 12.4247 23.6849C12.0677 19.9389 11.6013 17.2302 11.0253 15.5588C10.4789 13.8846 9.74845 13.091 8.83408 13.1782C7.9197 13.2653 7.33755 14.1839 7.08762 15.934C6.86718 17.6813 6.93544 20.428 7.29238 24.174C7.64932 27.92 8.10243 30.6448 8.6517 32.3486C9.22766 34.02 9.97283 34.8121 10.8872 34.725ZM20.3505 18.7777L17.0322 19.0939C17.2542 20.174 17.4438 21.5399 17.6012 23.1917C17.7361 24.6075 17.805 25.6427 17.8079 26.2972L21.0377 25.9894L20.3505 18.7777ZM70.1755 36.6402L65.3863 36.9623L64.3397 21.3974L61.6347 21.5793L62.565 35.4147L51.5676 36.1542L49.4505 4.66976L53.5745 4.39245L54.3021 15.2125L56.7854 15.0455L56.0578 4.22547L60.4479 3.93027L61.2619 16.0363L63.967 15.8544L63.0963 2.90584L67.8855 2.5838L70.1755 36.6402ZM48.0759 4.76219L50.1929 36.2466L39.2842 36.9802L37.1672 5.49571L41.5572 5.20052L42.2848 16.0205L44.7237 15.8565L43.9962 5.03652L48.0759 4.76219ZM45.0666 20.9561L42.6277 21.1201L43.3314 31.5854L45.7704 31.4214L45.0666 20.9561ZM57.1283 20.1451L54.645 20.3121L55.3487 30.7773L57.832 30.6103L57.1283 20.1451Z"
          fill="#4A9F99"
        />
        <path
          d="M98.4052 17.9988L97.7325 1.30122L103.372 1.07401L104.045 17.7716L98.4052 17.9988ZM84.3866 13.4038C83.172 14.9058 81.6506 16.1532 79.8224 17.1461C77.9943 18.139 75.9576 18.74 73.7123 18.9491L73.5137 14.0198C75.6962 13.7243 77.4741 12.9558 78.8474 11.7143C80.2492 10.442 81.108 8.93959 81.4237 7.20695L73.741 7.51646L73.5514 2.80917L94.5121 1.96473L94.7018 6.67202L87.1523 6.97616C87.1146 7.51145 86.9668 8.25875 86.7089 9.21805L95.9027 13.2957L93.8132 17.739L84.3866 13.4038ZM105.229 35.0268L76.1864 36.1968L75.7964 26.5158L98.7999 25.5891L98.7248 23.7239L75.6768 24.6524L75.5033 20.3448L104.102 19.1926L104.496 28.9625L81.5367 29.8875L81.6083 31.6638L105.056 30.7192L105.229 35.0268ZM133.322 11.2367C131.614 12.583 129.533 13.6359 127.079 14.3953C124.625 15.125 122.036 15.5299 119.31 15.6098L119.274 10.7655C121.91 10.6862 124.366 10.1935 126.64 9.28733C128.944 8.3513 130.476 7.11001 131.234 5.56346L119.635 5.65152L119.598 0.851655L148.397 0.633039L148.434 5.4329L137.279 5.51758C137.134 6.02239 136.931 6.60173 136.67 7.25559L149.364 10.8927L147.889 15.5707L133.322 11.2367ZM150.517 22.1731L136.961 22.276L136.999 27.2537L131.355 27.2965L131.317 22.3189L117.806 22.4214L117.769 17.5327L150.479 17.2844L150.517 22.1731ZM149.017 29.5625L149.055 34.4957L119.9 34.717L119.824 24.7617L125.557 24.7182L125.596 29.7403L149.017 29.5625ZM184.062 35.2047L178.463 35.1002L179.101 0.9728L184.7 1.07736L184.062 35.2047ZM174.241 1.72665L173.652 33.2767L154.633 32.9215L155.222 1.37149L160.777 1.47521L160.58 12.0511L168.489 12.1989L168.687 1.62292L174.241 1.72665ZM168.389 17.5757L160.479 17.428L160.289 27.604L168.199 27.7517L168.389 17.5757ZM193.012 26.5757C194.108 26.6148 194.998 27.0024 195.683 27.7384C196.369 28.4745 196.691 29.4051 196.651 30.5303C196.631 31.0929 196.537 31.6381 196.37 32.1658C196.233 32.6945 195.939 33.4549 195.488 34.4469L192.863 40.7127L189.043 40.5762L191.112 33.7124C190.439 33.4511 189.921 33.0176 189.557 32.4116C189.194 31.776 189.027 31.0585 189.056 30.259C189.096 29.1338 189.484 28.2285 190.22 27.5433C190.986 26.8591 191.917 26.5365 193.012 26.5757ZM228.157 23.9211L229.417 3.29286L234.563 3.6073L234.159 10.2172L237.043 10.3934L237.452 3.69477L242.554 4.0065L241.247 25.3888L236.146 25.0771L236.731 15.495L233.848 15.3188L233.303 24.2355L228.157 23.9211ZM226.866 22.4618C224.981 23.1779 222.161 23.4211 218.405 23.1916L209.4 22.6414L209.674 18.1608L215.618 18.5241L215.8 15.5518L210.787 15.2455L211.551 2.73551L226.413 3.64359L226.147 7.99103L216.432 7.3974L216.201 11.1681L226.316 11.7862L226.047 16.178L220.946 15.8663L220.767 18.7941C223.615 18.8197 225.739 18.5488 227.139 17.9813L226.866 22.4618ZM233.086 33.6175C231.888 34.7614 230.53 35.6135 229.011 36.1737C227.52 36.7654 225.976 37.0272 224.377 36.9592L218.843 32.7917C217.676 33.9079 216.334 34.746 214.815 35.3063C213.325 35.898 211.795 36.1607 210.225 36.0945L210.537 30.9929C212.284 31.07 213.849 30.468 215.234 29.1871C216.648 27.908 217.531 26.3293 217.883 24.451L223.066 25.6137C222.811 26.8746 222.414 28.0229 221.876 29.0587L225.806 31.7923C227.273 31.5851 228.578 30.8782 229.72 29.6716C230.864 28.4353 231.606 26.9816 231.946 25.3103L237.173 26.4757C236.859 27.733 236.479 28.8526 236.033 29.8347L242.183 34.1288L239.169 38.2638L233.086 33.6175ZM275.462 41.1247L270.15 40.6528L271.534 25.0697L267.86 24.7433L266.527 39.7509L261.258 39.2829L264.216 5.99177L269.484 6.45973L268.355 19.1653L272.03 19.4916L273.17 6.65331L278.482 7.1252L275.462 41.1247ZM261.09 6.51729L260.217 16.3453C259.814 20.8903 258.849 24.7163 257.324 27.8231C255.828 30.9326 253.944 33.2194 251.672 34.6834C249.43 36.15 246.994 36.7814 244.365 36.5776L244.853 31.0881C246.604 31.1247 248.17 30.5796 249.549 29.4528C250.958 28.3285 252.12 26.6321 253.035 24.3635C253.951 22.0948 254.551 19.352 254.837 16.1351L255.262 11.3539L246.673 10.591L247.145 5.27858L261.09 6.51729ZM297.669 31.576C297.802 30.4878 298.112 29.5405 298.598 28.7342C299.088 27.8985 299.633 27.2188 300.235 26.6951C300.869 26.1456 301.675 25.5277 302.655 24.8412C303.795 24.055 304.657 23.3541 305.239 22.7386C305.822 22.1231 306.167 21.3742 306.275 20.4919C306.422 19.286 306.055 18.2562 305.174 17.4026C304.293 16.5489 303.044 16.0234 301.426 15.8261C298.455 15.4638 296.025 16.3016 294.135 18.3396L289.836 15.0393C291.29 13.3958 293.091 12.2126 295.239 11.4895C297.39 10.7371 299.863 10.5312 302.657 10.872C305.981 11.2774 308.54 12.3208 310.335 14.0024C312.162 15.6581 312.922 17.7506 312.613 20.28C312.466 21.4859 312.131 22.5196 311.608 23.3811C311.115 24.2463 310.534 24.9665 309.867 25.5418C309.233 26.0913 308.41 26.7222 307.398 27.4345C306.125 28.324 305.179 29.1041 304.56 29.7748C303.945 30.4161 303.574 31.2515 303.449 32.2809L297.669 31.576ZM299.279 42.6076C298.191 42.4748 297.335 42.0272 296.711 41.2646C296.092 40.4727 295.843 39.5767 295.965 38.5767C296.09 37.5473 296.545 36.7521 297.33 36.1911C298.119 35.6007 299.057 35.3719 300.145 35.5047C301.233 35.6374 302.089 36.085 302.713 36.8476C303.369 37.5843 303.634 38.4674 303.509 39.4968C303.387 40.4968 302.915 41.3049 302.094 41.9211C301.305 42.5115 300.367 42.7403 299.279 42.6076Z"
          fill="#060606"
        />
      </svg>
    </div>
  );
};

export default CurveHeadLine;
