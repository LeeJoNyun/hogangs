import gsap from 'gsap';
import { ScrollTrigger } from 'gsap/all';
import { useEffect, useLayoutEffect, useRef } from 'react';

gsap.registerPlugin(ScrollTrigger);

const CurveHeadLine = () => {
    const tpRef = useRef(null);
    const textRef = useRef(null);
    const svgRef = useRef(null);

    useLayoutEffect(() => {
        const ctx = gsap.context(() => {
            const tp = tpRef.current;

            gsap.set(tpRef.current, {
                attr: { startOffset: '-30%' },
            });
            gsap.set(textRef.current, { opacity: 0, letterSpacing: 2 });

            ScrollTrigger.create({
                trigger: svgRef.current,
                start: 'top 80%',
                // end: 'top 20%',
                // markers: true,

                onEnter: () => {
                    gsap.to(tpRef.current, {
                        attr: { startOffset: '28%' },
                        duration: 3,
                    });
                    gsap.to(textRef.current, { opacity: 1, letterSpacing: 0.5 });
                },
            });
        }, svgRef);
        return () => ctx.revert();
    }, []);

    return (
        <div className="headlineWrap">
            <svg
                className="headline"
                ref={svgRef}
                width="1200"
                viewBox="0 0 1200 100"
                role="img"
                aria-label="호강할 준비, 됐개?"
            >
                <path id="curve" d="M80,180 C380,20 820,20 1120,180" fill="none" />

                <text ref={textRef} fontSize="68" fontWeight="700" fontFamily="Paperlogy">
                    <textPath ref={tpRef} href="#curve" startOffset="0%">
                        {/* 부분 색상 분리 */}
                        <tspan fill="#4A9F99">예뻐</tspan>
                        <tspan fill="#060606 ">질 준비, 됐개?</tspan>
                    </textPath>
                </text>
            </svg>
            <svg
                className="headlineMobile"
                xmlns="http://www.w3.org/2000/svg"
                width="314"
                height="45"
                viewBox="0 0 314 45"
                fill="none"
            >
                <path
                    d="M2.63769 16.9336L2.14444 11.757L14.4885 10.5808L14.1344 6.86431L19.8419 6.32046L20.196 10.037L32.5843 8.85652L33.0776 14.0331L2.63769 16.9336ZM36.4455 38.1334L3.88192 41.2363L3.38444 36.0155L16.8346 34.7338L16.4847 31.0616C13.0112 31.1545 10.2182 30.736 8.10564 29.8063C6.01979 28.8443 4.8785 27.3309 4.68176 25.2662C4.45691 22.9065 5.55942 21.0454 7.98927 19.6828C10.4163 18.2907 13.7536 17.3923 18.001 16.9876C22.2484 16.5829 25.6953 16.8349 28.3415 17.7435C30.985 18.6226 32.4191 20.242 32.644 22.6017C32.8407 24.6664 31.991 26.3695 30.0949 27.711C28.196 29.023 25.547 29.96 22.148 30.522L22.4979 34.1942L35.9481 32.9126L36.4455 38.1334ZM10.3892 24.7223C10.4623 25.4892 11.2531 25.9794 12.7616 26.1928C14.2969 26.3739 16.3328 26.3436 18.8695 26.1019C21.4061 25.8602 23.3964 25.5068 24.8403 25.0419C26.3108 24.5446 27.0096 23.9125 26.9365 23.1456C26.8634 22.3787 26.0593 21.9047 24.5241 21.7236C23.0155 21.5101 20.993 21.5243 18.4563 21.766C15.9196 22.0077 13.916 22.3772 12.4455 22.8745C11.0016 23.3395 10.3162 23.9554 10.3892 24.7223ZM71.5718 14.6621L67.5365 14.9334L67.9957 21.7625L62.4083 22.1382L61.1589 3.55791L66.7463 3.1822L67.1548 9.25737L71.1901 8.98603L71.5718 14.6621ZM56.7924 8.84054C57.0985 13.3932 55.6105 16.8787 52.3283 19.2969C49.0461 21.7152 44.4635 23.1221 38.5805 23.5177L38.2465 18.5511C42.3518 18.2157 45.559 17.3318 47.8681 15.8996C50.2068 14.4654 51.3016 12.6397 51.1525 10.4225L51.1048 9.71298L37.7128 10.6135L37.3818 5.69127L56.4942 4.40611L56.7924 8.84054ZM54.0306 23.4142C58.4059 23.12 61.9341 23.4767 64.6151 24.4843C67.2962 25.4919 68.7261 27.326 68.9051 29.9867C69.082 32.6177 67.9094 34.612 65.3874 35.9695C62.8654 37.3269 59.4167 38.1527 55.0414 38.4469C50.6661 38.7411 47.1379 38.3845 44.4569 37.3769C41.7758 36.3693 40.3469 34.55 40.1699 31.9189C39.991 29.2582 41.1626 27.2491 43.6846 25.8917C46.2066 24.5343 49.6553 23.7084 54.0306 23.4142ZM54.7224 33.7021C57.2352 33.5331 59.2306 33.1762 60.7085 32.6314C62.2159 32.0846 62.9378 31.3382 62.8742 30.3922C62.8106 29.4462 61.9953 28.8031 60.4282 28.463C58.8591 28.0934 56.8329 27.9921 54.3496 28.1591C51.8368 28.328 49.8276 28.7007 48.3222 29.2771C46.8147 29.8239 46.0928 30.5703 46.1564 31.5163C46.22 32.4623 47.0354 33.1054 48.6025 33.4454C50.1696 33.7855 52.2095 33.8711 54.7224 33.7021Z"
                    fill="#4A9F99"
                />
                <path
                    d="M72.6799 8.96188L72.5118 4.78749L80.6829 4.4583L80.5773 1.83821L86.306 1.60742L86.4116 4.22751L94.6271 3.89653L94.7953 8.07092L72.6799 8.96188ZM107.265 12.8617L103.224 13.0245L103.478 19.3305L97.8824 19.556L97.1685 1.83701L102.764 1.61158L103.009 7.69554L107.05 7.53273L107.265 12.8617ZM84.2135 20.329C81.401 20.4424 79.0585 20.0771 77.1859 19.2333C75.3122 18.3598 74.3402 17.0498 74.2698 15.303C74.1994 13.5563 75.0493 12.2025 76.8195 11.2415C78.6181 10.2498 80.9384 9.69671 83.7806 9.58221C86.6227 9.46771 88.9652 9.83296 90.8081 10.678C92.6795 11.4922 93.6503 12.7727 93.7207 14.5194C93.7911 16.2661 92.9276 17.6502 91.1302 18.6715C89.3316 19.6632 87.0261 20.2157 84.2135 20.329ZM83.9326 13.3569C82.5412 13.413 81.4369 13.6057 80.6199 13.9352C79.8313 14.2338 79.4465 14.62 79.4656 15.0937C79.4859 15.597 79.901 15.9658 80.7111 16.2C81.5508 16.4331 82.6664 16.5216 84.0579 16.4655C85.4493 16.4095 86.5394 16.2321 87.328 15.9334C88.1166 15.6348 88.5008 15.2338 88.4805 14.7305C88.4614 14.2568 88.032 13.9035 87.1923 13.6704C86.3811 13.4066 85.2945 13.3021 83.9326 13.3569ZM104.464 31.6564L104.621 35.5643L75.9777 36.7183L75.6056 27.4813L98.2983 26.5671L98.2285 24.8352L75.447 25.753L75.2895 21.8451L103.533 20.7072L103.904 29.8997L81.3441 30.8086L81.4157 32.5849L104.464 31.6564ZM133.646 11.7367C131.938 13.083 129.857 14.1359 127.403 14.8953C124.95 15.625 122.36 16.0299 119.635 16.1098L119.598 11.2655C122.234 11.1862 124.69 10.6935 126.965 9.78733C129.269 8.8513 130.8 7.61001 131.559 6.06346L119.959 6.15152L119.922 1.35165L148.722 1.13304L148.758 5.9329L137.603 6.01758C137.459 6.52239 137.256 7.10173 136.994 7.75559L149.688 11.3927L148.213 16.0707L133.646 11.7367ZM150.841 22.6731L137.286 22.776L137.323 27.7537L131.679 27.7965L131.641 22.8189L118.131 22.9214L118.094 18.0327L150.804 17.7844L150.841 22.6731ZM149.341 30.0625L149.379 34.9957L120.224 35.217L120.148 25.2617L125.882 25.2182L125.92 30.2403L149.341 30.0625ZM184.387 35.7047L178.788 35.6002L179.425 1.4728L185.024 1.57736L184.387 35.7047ZM174.566 2.22665L173.976 33.7767L154.957 33.4215L155.547 1.87149L161.101 1.97521L160.904 12.5511L168.813 12.6989L169.011 2.12292L174.566 2.22665ZM168.713 18.0757L160.803 17.928L160.613 28.104L168.523 28.2517L168.713 18.0757ZM193.336 27.0757C194.432 27.1148 195.322 27.5024 196.008 28.2384C196.693 28.9745 197.015 29.9051 196.975 31.0303C196.955 31.5929 196.862 32.1381 196.695 32.6658C196.557 33.1945 196.263 33.9549 195.813 34.9469L193.187 41.2127L189.367 41.0762L191.436 34.2124C190.763 33.9511 190.245 33.5176 189.881 32.9116C189.519 32.276 189.352 31.5585 189.38 30.759C189.42 29.6338 189.808 28.7285 190.545 28.0433C191.31 27.3591 192.241 27.0365 193.336 27.0757ZM228.481 24.4211L229.742 3.79286L234.887 4.1073L234.484 10.7172L237.367 10.8934L237.776 4.19477L242.878 4.5065L241.571 25.8888L236.47 25.5771L237.055 15.995L234.172 15.8188L233.627 24.7355L228.481 24.4211ZM227.19 22.9618C225.306 23.6779 222.486 23.9211 218.73 23.6916L209.724 23.1414L209.998 18.6608L215.942 19.0241L216.124 16.0518L211.111 15.7455L211.876 3.23551L226.737 4.14359L226.471 8.49103L216.756 7.8974L216.525 11.6681L226.64 12.2862L226.372 16.678L221.27 16.3663L221.091 19.2941C223.939 19.3197 226.063 19.0488 227.464 18.4813L227.19 22.9618ZM233.41 34.1175C232.212 35.2614 230.854 36.1135 229.335 36.6737C227.845 37.2654 226.3 37.5272 224.701 37.4592L219.167 33.2917C218.001 34.4079 216.658 35.246 215.14 35.8063C213.649 36.398 212.119 36.6607 210.55 36.5945L210.861 31.4929C212.608 31.57 214.174 30.968 215.558 29.6871C216.972 28.408 217.855 26.8293 218.207 24.951L223.391 26.1137C223.135 27.3746 222.739 28.5229 222.2 29.5587L226.13 32.2923C227.597 32.0851 228.902 31.3782 230.044 30.1716C231.189 28.9353 231.93 27.4816 232.27 25.8103L237.498 26.9757C237.183 28.233 236.803 29.3526 236.357 30.3347L242.507 34.6288L239.493 38.7638L233.41 34.1175ZM275.787 41.6247L270.474 41.1528L271.858 25.5697L268.184 25.2433L266.851 40.2509L261.583 39.7829L264.54 6.49177L269.808 6.95973L268.679 19.6653L272.354 19.9916L273.494 7.15331L278.807 7.6252L275.787 41.6247ZM261.414 7.01729L260.541 16.8453C260.138 21.3903 259.173 25.2163 257.648 28.3231C256.152 31.4326 254.268 33.7194 251.997 35.1834C249.754 36.65 247.318 37.2814 244.689 37.0776L245.177 31.5881C246.929 31.6247 248.494 31.0796 249.873 29.9528C251.282 28.8285 252.444 27.1321 253.359 24.8635C254.275 22.5948 254.875 19.852 255.161 16.6351L255.586 11.8539L246.997 11.091L247.469 5.77858L261.414 7.01729ZM297.993 32.076C298.126 30.9878 298.436 30.0405 298.922 29.2342C299.412 28.3985 299.958 27.7188 300.559 27.1951C301.193 26.6456 302 26.0277 302.979 25.3412C304.119 24.555 304.981 23.8541 305.564 23.2386C306.146 22.6231 306.491 21.8742 306.599 20.9919C306.746 19.786 306.379 18.7562 305.498 17.9026C304.617 17.0489 303.368 16.5234 301.75 16.3261C298.78 15.9638 296.349 16.8016 294.459 18.8396L290.16 15.5393C291.614 13.8958 293.415 12.7126 295.563 11.9895C297.714 11.2371 300.187 11.0312 302.981 11.372C306.305 11.7774 308.864 12.8208 310.659 14.5024C312.487 16.1581 313.246 18.2506 312.938 20.78C312.791 21.9859 312.456 23.0196 311.933 23.8811C311.439 24.7463 310.859 25.4665 310.192 26.0418C309.557 26.5913 308.734 27.2222 307.722 27.9345C306.449 28.824 305.504 29.6041 304.884 30.2748C304.269 30.9161 303.898 31.7515 303.773 32.7809L297.993 32.076ZM299.603 43.1076C298.515 42.9748 297.659 42.5272 297.036 41.7646C296.416 40.9727 296.167 40.0767 296.289 39.0767C296.414 38.0473 296.87 37.2521 297.654 36.6911C298.443 36.1007 299.381 35.8719 300.469 36.0047C301.558 36.1374 302.413 36.585 303.037 37.3476C303.693 38.0843 303.959 38.9674 303.833 39.9968C303.711 40.9968 303.239 41.8049 302.418 42.4211C301.63 43.0115 300.691 43.2403 299.603 43.1076Z"
                    fill="#060606"
                />
            </svg>
        </div>
    );
};

export default CurveHeadLine;
